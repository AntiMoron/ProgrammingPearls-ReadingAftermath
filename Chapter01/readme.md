# 前言

## 关于Jhon Bentley
世界著名计算机科学家，是大师们的老师。教授过的学生包括：Tcl语言设计者John Outerhout、Java语言设计者James Gosling,算法导论作者之一
Charles Leiserson。屌极了。

# 初始章

## 好好说人话 :]
现在的世界，戾气颇重。好多人不明分说，张嘴就喷。因为和有因果关系可以喷的心服口服的人比，见识广学不来喷人倒是很容易学。也算是成功的第一步了。

1. 不爽开喷。
2. 没耐心，听到一句话就直接猜测对方的意图。文章开篇给我上了一课，猜测是好的，是思考的第一步，但是应该把对方的诉求听完。
3. 太自满，以为自己已经解决了对方问题实际毫无帮助

但是读完这章多少能让我们更加掌握沟通的技巧和要领些。

## 简单的耐心的询问

> 说有一个同学问一个问题：怎么给磁盘文件排序。

大师上来就各种提供思路，想当然说了磁盘上归并排序的思路，钦定了算法教材，说教批判一番想要搞个大新闻。

同学： 8-|

大师看年轻人踌躇还说不明白，就有了接下来的疑问：
Q1:为什么要自己写排序？系统不是有提供了排序功能怎么不用？
A1:要在一个大的系统中排序。由于技术原因（我猜是框架设计如此，要手动实现某个回调之类的），总之不能用系统给的排序

Q2:排序啥玩意？数据是怎么样的？
A2:排序文件，最多包含1千万记录，每条记录是7位整数

Q3:文件这么小，为什么不在内存排序？
A3:尽管机器有好多MB内存，但是排序只是大系统一部分，有内存限制，估计大概就能用1MB

Q4:有啥补充信息吗？
A4:每条记录都是7位正整数，再无其他相关数据。每个整数最多出现1次。

## 更Geek的更精准的问题描述

0. 要干啥？
要排序一个文件里的7位unique正整数。

1. 输入
一个包含n个正整数文件，每个数小于n, 其中n=1e7。出现非Unique数则为指明错误。没有其他数据耦合。

2. 输出
升序排列输入里的整数列表

3. 约束
内存限制： 1MB
磁盘空间： 不限制
时间限制： 10秒钟最佳，(0, 几分钟)

## 静下来思考：不归并排序了，不按套路出牌有奇效

思考开始：
大致思路：
每个号码7字节存储（文件内读出char[7])，1MB大约存143000个数，远不足1e7，直接转化成Int32存的话，4B在1MB里大约可以存250000个号码，
那就可以用mmap的形式遍历文件40趟完成归并。

效率有点low，涉及到多次磁盘IO。

### 最终方案：
状态压缩，Hash一次排好。

e.g. 对于集合{0,1,2,3,4,5}，假如该集合只存比10小的非负整数。那可以状态压缩为：

二进制数： 1 1 1 1 1 1 0 0 0 0 一次表示该bit的索引号的数字是否存在于文件中。然后最后正序一次遍历并判断将结果输出。

## 结果

打电话说最后就10秒钟便完成了任务。